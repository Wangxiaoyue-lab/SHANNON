# Methods

| value | tool | time | platform | link | description |  |
| ----- | ---- | ---- | -------- | ---- | ----------- | - |
|       |      |      |          |      |             |  |
|       |      |      |          |      |             |  |
|       |      |      |          |      |             |  |
|       |      |      |          |      |             |  |
|       |      |      |          |      |             |  |
|       |      |      |          |      |             |  |
|       |      |      |          |      |             |  |

# Benchmark

# Details

## sva | 批次分组未知 | 芯片或者转化为连续的RNAseq

直接从表达数据中估计所有未测量因子的影响。移除主要变量的贡献获得残差表达矩阵:对残差表达矩阵进行分解列如SVD或PCA方法)，通过残基表达矩阵上的基因与潜在因子之间关联的显著性识别出引起表达变异的基因表达子集，即与感兴趣的生物因子不相关的其他潜在因子引起的基因表达值变异部分;对每个基因子集，根据原始表达数据中该子集的批次效应信号构建一个替代变量:重新构建删除批次效应的数据集。


适用于批次分组未知的情况下批次效应的去除。该方法的同限性在于只去除主要的批次效应。SVD可能无法识别和删除所有批处理效应，并且可能删除与批处理无关的其他效应。SVD的一个基本假设是特征向量具有高斯分布。不适用于样本量较少的情况。


## combat | 批次分组已知| 芯片或者转化为连续的RNAseq

ComBat法基于估计参数的先验分布，为每个基因独立估，算每个批次的均值和方差并进行调整。经验贝叶斯方法(Empirical Bayesmethod)的思想是从基因和实验条件中使用“先验信息”，期望利用先验信息得到更好的估计或者更稳定的推断。

该方法总体优于其他方法，适用于批次分组已知情况下批次效应的去除。对小样本数据更加有效。


## sva-seq | RNAseq counts数据

https://academic.oup.com/nar/article/42/21/e161/2903156


## combat-seq | RNAseq counts数据

https://github.com/zhangyuqing/ComBat-seq

https://academic.oup.com/nargab/article/doi/10.1093/nargab/lqaa078/5909519


ComBat-seq 采用**未转换的原始计数矩阵**作为输入。与 ComBat 相同，它需要一个已知的批处理变量。

使用负二项式回归来模拟批次效应，然后在没有批次效应的情况下通过将原始数据映射到预期分布来提供调整后的数据。与 ComBat 假设的高斯分布相比，这种方法可以更好地捕获 RNA-Seq 计数数据的特性。ComBat-seq 指定跨批次的不同分散参数，从而可以对基因表达的方差进行灵活的建模。此外，ComBat-seq提供调整后的数据，保留计数的整数性质，以便调整后的数据与最先进的差异表达软件（例如edgeR、DESeq2，它们特别要求未转换的计数数据）的假设兼容）。



## complete confounding | 完全混杂

当条件分组与批次分组完全重合时，即每个条件只在一个批次中出现，这种情况被称为完全混杂（complete confounding）。在这种情况下，无法使用统计方法（如 ComBat 或 SVA）来区分批次效应和条件效应，因为这两种效应无法被区分。
在这种情况下，可以考虑使用其他方法来处理批次效应，如使用技术重复或生物学重复来估计批次效应的大小，并对数据进行校正。此外，也可以考虑使用其他类型的数据（如代谢组学数据或蛋白质组学数据）来帮助区分批次效应和条件效应。


# Comments
